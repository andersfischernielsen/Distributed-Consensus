% !TeX root = ../DCR-Consensus.tex
\section{Stitch}
\subsection{Goal} % Hvad er problemet
The goal of the algortithm is, given a collection of partially ordered histories, to merge the histories into one history which includes all of the logs of the histories, such that the resulting history remains partially ordered in accordance to the ruleset described in \ref{chap:domainanalysis}.

%Logs should not be understood as executions only but all the different kinds of logs, see log description.
%A partially ordered graph should not contain cycles.

\subsection{Implementation} % hvordan løses det
To solve the problem a datastructure which represents the partial ordered history has to be introduced. Such a datastructure requires the following functions:

\begin{lstlisting}[breaklines=true]
Add graph node:
    if exists graph node
        union matching node edge sets.
    else
        Add node to list of nodes.


Add graph edge:
	Add edge to source node.

Stitch Algorithm:
	foreach graph in list of graphs
		foreach node in graph
			add node to local graph
	for each node1 in localgraph
		foreach node2 in localgraph
			If node1 and node2 does not have an edge 
				if node1 and node2 has a happen before relation
					create edge from node1 to node2
	Cyclecheck
\end{lstlisting}

\subsection{Discussion} % bliver problemet løst
\subsection{Performance} % hvor godt løses det

